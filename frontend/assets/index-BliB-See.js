import{af as _,d as de,r as u,o as Te,a as Ke,g as s,S as q,e as te,i as g,f as l,w as t,Q as v,j as ae,m as oe,D as Q,y as k,k as V,R as Be,z as r,t as W,ae as Me,T as b,I as C,U as D,V as z,W as $,X as Ae,ag as ne}from"./index-_hVn5I9W.js";const Ee=p=>_.get("/koi/sysDept/list",p),qe=()=>_.get("/koi/sysDept/cascaderList"),$e=p=>_.get("/koi/sysDept/getById/"+p),Le=p=>_.post("/koi/sysDept/update",p),Re=p=>_.post("/koi/sysDept/add",p),Ye=p=>_.post("/koi/sysDept/deleteById/"+p),Pe=p=>_.post("/koi/sysDept/batchDelete",p),Oe=(p,U)=>_.post("/koi/sysDept/updateStatus/"+p+"/"+U),Qe=(p,U)=>_.post("/koi/sysDept/updateSpread/"+p+"/"+U),We={class:"koi-flex"},ze={key:0},Fe=de({name:"deptPage"}),Ge=de({...Fe,setup(p){const U=u(!1),L=u(!0),F=u([{id:1,deptId:1,deptName:"YU-ADMINðŸŒ»",leader:"YU-ADMIN",phone:"18588888888",email:"xxxxxx@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00",children:[{id:3,deptId:3,deptName:"ç ”å‘éƒ¨é—¨ðŸŒ»",leader:"YU-ADMIN",phone:"18588888888",email:"xxxxxx@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00"},{id:4,deptId:4,deptName:"é”€å”®éƒ¨é—¨ðŸŒ»",leader:"è™Žç‰™688å¼ å¤§ä»™",phone:"18566666666",email:"666666@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00"}]},{id:2,deptId:2,deptName:"ç¥–å®‰å…¬å¸ðŸŒ»",leader:"YU-ADMIN",phone:"18577777777",email:"xxxxxx@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00",children:[{id:5,deptId:5,deptName:"è¿ç»´éƒ¨é—¨ðŸŒ»",leader:"YU-ADMIN",phone:"18577777777",email:"xxxxxx@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00"},{id:6,deptId:6,deptName:"æµ‹è¯•éƒ¨é—¨ðŸŒ»",leader:"è™Žç‰™688å¼ å¤§ä»™",phone:"18577777777",email:"666666@163.com",deptStatus:"0",isSpread:"1",sorted:1,remark:"æˆ‘æ˜¯å¤©æ‰ðŸŒ»",createTime:"2023-08-08 23:00:00"}]}]),x=u({deptName:"",phone:"",deptStatus:""}),re=()=>{x.value={deptName:"",phone:"",deptStatus:""}},se=()=>{console.log("æœç´¢"),h()},pe=()=>{console.log("é‡ç½®æœç´¢"),re(),h()},h=async()=>{},T=async()=>{try{const a=await Ee(x.value);console.log("éƒ¨é—¨æ•°æ®è¡¨æ ¼æ•°æ®->",a.data),F.value=ne(a.data,"deptId"),ue(a.data)}catch(a){console.log(a),D("æ•°æ®æŸ¥è¯¢å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}},B=u(),ue=a=>{if(a!=null&&a.length!=0){B.value=[];const e=[];a.forEach(d=>{d.parentId=="0"&&d.isSpread=="0"&&e.push(d.deptId),d.parentId!="0"&&d.isSpread=="0"&&(e.push(d.deptId),e.push(d.parentId))});const i=[...new Set(e)];console.log("å±•å¼€èŠ‚ç‚¹",i),B.value=i.map(String)}else B.value=[]};Te(()=>{h()});const M=u([]),X=u(!0),G=u(!0),ie=a=>{M.value=a.map(e=>e.id),X.value=a.length!=1,G.value=!a.length};let A=u([]);const H=async()=>{try{A.value=[];const a=await qe();A.value=ne(a.data,"value"),A.value.unshift({label:"æœ€é¡¶çº§éƒ¨é—¨",value:"0",parentId:"-1"})}catch(a){console.log(a),C("éƒ¨é—¨çº§è”æ•°æ®æŸ¥è¯¢å¤±è´¥ï¼Œè¯·é‡è¯•ðŸŒ»")}},R=u(!0),Y=u(!1),ce=()=>{R.value=!1,Y.value=!Y.value,Me(()=>{R.value=!0})},me=()=>{K(),P.value="éƒ¨é—¨æ·»åŠ ",H(),n.value.parentId="0",n.value.deptStatus="0",w.value.koiOpen(),b("æ·»åŠ ðŸŒ»")},fe=async a=>{if(a==null||a==""){$("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»");return}try{const e=await $e(a);console.log("éƒ¨é—¨å›žæ˜¾æ•°æ®",e.data),n.value=e.data}catch(e){console.log(e),D("æ•°æ®èŽ·å–å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}},J=async a=>{K(),P.value="éƒ¨é—¨ä¿®æ”¹";const e=a?a.id:M.value[0];(e==null||e=="")&&C("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»"),H(),fe(e),w.value.koiOpen(),b("ä¿®æ”¹ðŸŒ»")},w=u(),P=u("éƒ¨é—¨ç®¡ç†"),O=u();let n=u({id:null,deptId:null,deptName:null,parentId:null,deptStatus:"0",leader:null,phone:null,email:null,sorted:1});const K=()=>{n.value={id:null,deptId:null,deptName:null,parentId:null,deptStatus:null,leader:null,phone:null,email:null,sorted:1}},ve=Ke({deptId:[{required:!0,message:"è¯·è¾“å…¥éƒ¨é—¨ç¼–å·",trigger:"blur"}],deptName:[{required:!0,message:"è¯·è¾“å…¥éƒ¨é—¨åå­—",trigger:"blur"}],parentId:[{required:!0,message:"è¯·é€‰æ‹©ä¸Šçº§éƒ¨é—¨",trigger:"blur"}],deptStatus:[{required:!0,message:"è¯·è¾“å…¥é€‰æ‹©éƒ¨é—¨çŠ¶æ€",trigger:"blur"}],leader:[{required:!0,message:"è¯·è¾“å…¥è´Ÿè´£äººåå­—",trigger:"blur"}],phone:[{required:!0,message:"è¯·è¾“å…¥æ‰‹æœºå·ç ",trigger:"blur"}],sorted:[{required:!0,message:"è¯·è¾“å…¥æŽ’åºå·",trigger:"blur"}]}),S=u(!1),he=()=>{O.value&&(S.value=!0,O.value.validate(async a=>{if(a)if(n.value.id!=null&&n.value.id!="")try{await Le(n.value),b("ä¿®æ”¹æˆåŠŸðŸŒ»"),S.value=!1,w.value.koiQuickClose(),K(),h()}catch(e){console.log(e),S.value=!1,D("ä¿®æ”¹å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}else try{await Re(n.value),b("æ·»åŠ æˆåŠŸðŸŒ»"),S.value=!1,w.value.koiQuickClose(),K(),h()}catch(e){console.log(e),S.value=!1,D("æ·»åŠ å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}else C("éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥å¡«å†™å†…å®¹ðŸŒ»"),S.value=!1}))},ge=()=>{w.value.koiClose()},_e=a=>{let e=a.deptStatus==="0"?"å¯ç”¨":"åœç”¨";z("ç¡®è®¤è¦["+e+"]-["+a.deptName+"]éƒ¨é—¨å—ï¼Ÿ").then(async()=>{if(K(),!a.id||!a.deptStatus){$("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»");return}try{await Oe(a.id,a.deptStatus),b("ä¿®æ”¹æˆåŠŸðŸŒ»")}catch(i){T(),console.log(i),D("ä¿®æ”¹å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}}).catch(()=>{C("å·²å–æ¶ˆðŸŒ»")})},xe=async a=>{if(!a.id||!a.isSpread){$("è¯·é€‰æ‹©éœ€è¦å±•å¼€çš„æ•°æ®ðŸŒ»");return}try{await Qe(a.id,a.isSpread),T(),b("æ“ä½œæˆåŠŸðŸŒ»")}catch(e){T(),console.log(e),D("æ“ä½œå¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}},ye=a=>{const e=a.id;if(e==null||e==""){$("è¯·é€‰ä¸­éœ€è¦åˆ é™¤çš„æ•°æ®ðŸŒ»");return}z("æ‚¨ç¡®è®¤éœ€è¦åˆ é™¤éƒ¨é—¨åç§°["+a.deptName+"]ä¹ˆï¼Ÿ").then(async()=>{try{await Ye(e),b("åˆ é™¤æˆåŠŸðŸŒ»"),T()}catch(i){console.log(i)}}).catch(()=>{C("å·²å–æ¶ˆðŸŒ»")})},be=()=>{if(M.value.length==0){Ae("è¯·é€‰æ‹©éœ€è¦åˆ é™¤çš„æ•°æ®ðŸŒ»");return}z("æ‚¨ç¡®è®¤éœ€è¦è¿›è¡Œæ‰¹é‡åˆ é™¤ä¹ˆï¼Ÿåˆ é™¤åŽå°†æ— æ³•è¿›è¡Œæ¢å¤ï¼Ÿ").then(async()=>{try{await Pe(M.value),b("æ‰¹é‡åˆ é™¤æˆåŠŸðŸŒ»"),T()}catch(a){console.log(a)}}).catch(()=>{C("å·²å–æ¶ˆðŸŒ»")})};return(a,e)=>{const i=s("el-input"),d=s("el-form-item"),E=s("el-option"),Z=s("el-select"),y=s("el-button"),j=s("el-form"),c=s("el-col"),Se=s("KoiToolbar"),I=s("el-row"),m=s("el-table-column"),ee=s("el-switch"),le=s("el-tooltip"),ke=s("el-table"),Ve=s("el-cascader"),we=s("el-input-number"),Ie=s("KoiDialog"),Ne=s("KoiCard"),Ce=q("throttle"),De=q("debounce"),N=q("auth"),Ue=q("loading");return g(),te("div",We,[l(Ne,null,{default:t(()=>[v(l(j,{inline:!0},{default:t(()=>[l(d,{label:"éƒ¨é—¨åç§°",prop:"deptName"},{default:t(()=>[l(i,{placeholder:"è¯·è¾“å…¥éƒ¨é—¨åç§°",modelValue:x.value.deptName,"onUpdate:modelValue":e[0]||(e[0]=o=>x.value.deptName=o),clearable:"",style:{width:"240px"},onKeyup:Q(h,["enter","native"])},null,8,["modelValue"])]),_:1}),l(d,{label:"éƒ¨é—¨çŠ¶æ€",prop:"deptStatus"},{default:t(()=>[l(Z,{placeholder:"è¯·é€‰æ‹©éƒ¨é—¨çŠ¶æ€",modelValue:x.value.deptStatus,"onUpdate:modelValue":e[1]||(e[1]=o=>x.value.deptStatus=o),clearable:"",style:{width:"240px"},onKeyup:Q(h,["enter","native"])},{default:t(()=>[l(E,{label:"å¯ç”¨",value:"0"}),l(E,{label:"åœç”¨",value:"1"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"è”ç³»ç”µè¯",prop:"phone"},{default:t(()=>[l(i,{placeholder:"è¯·è¾“å…¥è”ç³»ç”µè¯",modelValue:x.value.phone,"onUpdate:modelValue":e[2]||(e[2]=o=>x.value.phone=o),clearable:"",style:{width:"240px"},onKeyup:Q(h,["enter","native"])},null,8,["modelValue"])]),_:1}),l(d,null,{default:t(()=>[v((g(),k(y,{type:"primary",icon:"search",plain:""},{default:t(()=>e[17]||(e[17]=[V("æœç´¢")])),_:1,__:[17]})),[[Ce,se]]),v((g(),k(y,{type:"danger",icon:"refresh",plain:""},{default:t(()=>e[18]||(e[18]=[V("é‡ç½®")])),_:1,__:[18]})),[[De,pe]])]),_:1})]),_:1},512),[[Be,L.value]]),l(I,{gutter:10},{default:t(()=>[v((g(),k(c,{span:1.5},{default:t(()=>[l(y,{type:"primary",icon:"plus",plain:"",onClick:e[3]||(e[3]=o=>me())},{default:t(()=>e[19]||(e[19]=[V("æ–°å¢ž")])),_:1,__:[19]})]),_:1})),[[N,["system:role:add"]]]),v((g(),k(c,{span:1.5},{default:t(()=>[l(y,{type:"success",icon:"edit",plain:"",onClick:e[4]||(e[4]=o=>J()),disabled:X.value},{default:t(()=>e[20]||(e[20]=[V("ä¿®æ”¹")])),_:1,__:[20]},8,["disabled"])]),_:1})),[[N,["system:role:update"]]]),v((g(),k(c,{span:1.5},{default:t(()=>[l(y,{type:"danger",icon:"delete",plain:"",onClick:e[5]||(e[5]=o=>be()),disabled:G.value},{default:t(()=>e[21]||(e[21]=[V("åˆ é™¤")])),_:1,__:[21]},8,["disabled"])]),_:1})),[[N,["system:role:delete"]]]),v((g(),k(c,{span:1.5},{default:t(()=>[l(y,{type:"info",icon:"Sort",plain:"",onClick:e[6]||(e[6]=o=>ce())},{default:t(()=>e[22]||(e[22]=[V("å±•å¼€/æŠ˜å ")])),_:1,__:[22]})]),_:1})),[[N,["system:role:add"]]]),l(Se,{showSearch:L.value,"onUpdate:showSearch":e[7]||(e[7]=o=>L.value=o),onRefreshTable:h},null,8,["showSearch"])]),_:1}),e[23]||(e[23]=ae("br",null,null,-1)),R.value?v((g(),k(ke,{key:0,border:"",data:F.value,onSelectionChange:ie,"expand-row-keys":B.value,"default-expand-all":Y.value,"row-key":"deptId","tree-props":{children:"children",hasChildren:"hasChildren"},"empty-text":"æš‚æ—¶æ²¡æœ‰æ•°æ®å“ŸðŸŒ»"},{default:t(()=>[l(m,{type:"selection",width:"55",align:"center"}),l(m,{label:"åºå·",prop:"id",width:"80px",align:"center",type:"index"}),l(m,{label:"éƒ¨é—¨åç§°",prop:"deptName",width:"150px",align:"left","show-overflow-tooltip":!0}),l(m,{label:"å±•å¼€/æŠ˜å ",prop:"isSpread",width:"100px",align:"center"},{default:t(o=>[l(ee,{modelValue:o.row.isSpread,"onUpdate:modelValue":f=>o.row.isSpread=f,"active-text":"å±•å¼€","inactive-text":"æŠ˜å ","active-value":"0","inactive-value":"1","inline-prompt":!0,onClick:f=>xe(o.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),l(m,{label:"éƒ¨é—¨ç¼–å·",prop:"deptId",width:"100px",align:"center"}),l(m,{label:"è´Ÿè´£äºº",prop:"leader",width:"120px",align:"center"}),l(m,{label:"è”ç³»ç”µè¯",prop:"phone",width:"120px",align:"center"}),l(m,{label:"é‚®ç®±",prop:"email",width:"230px",align:"center","show-overflow-tooltip":!0}),l(m,{label:"éƒ¨é—¨çŠ¶æ€",prop:"deptStatus",width:"100px",align:"center"},{default:t(o=>[l(ee,{modelValue:o.row.deptStatus,"onUpdate:modelValue":f=>o.row.deptStatus=f,"active-text":"å¯ç”¨","inactive-text":"åœç”¨","active-value":"0","inactive-value":"1","inline-prompt":!0,onChange:f=>_e(o.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(m,{label:"æ˜¾ç¤ºé¡ºåº",prop:"sorted",width:"100px",align:"center"}),l(m,{label:"å¤‡æ³¨",prop:"remark",width:"180px",align:"center","show-overflow-tooltip":!0}),l(m,{label:"åˆ›å»ºæ—¶é—´",prop:"createTime",width:"180px",align:"center"}),l(m,{label:"æ“ä½œ",align:"center",width:"120",fixed:"right"},{default:t(({row:o})=>[l(le,{content:"ä¿®æ”¹ðŸŒ»",placement:"top"},{default:t(()=>[v(l(y,{type:"primary",icon:"Edit",circle:"",plain:"",onClick:f=>J(o)},null,8,["onClick"]),[[N,["system:role:update"]]])]),_:2},1024),l(le,{content:"åˆ é™¤ðŸŒ»",placement:"top"},{default:t(()=>[v(l(y,{type:"danger",icon:"Delete",circle:"",plain:"",onClick:f=>ye(o)},null,8,["onClick"]),[[N,["system:role:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","expand-row-keys","default-expand-all"])),[[Ue,U.value]]):oe("",!0),l(Ie,{ref_key:"koiDialogRef",ref:w,title:P.value,onKoiConfirm:he,onKoiCancel:ge,loading:S.value},{content:t(()=>[l(j,{ref_key:"formRef",ref:O,rules:ve,model:r(n),"label-width":"80px","status-icon":""},{default:t(()=>[l(I,null,{default:t(()=>[l(c,{xs:{span:24},sm:{span:12}},{default:t(()=>[l(d,{label:"éƒ¨é—¨ç¼–ç ",prop:"deptId"},{default:t(()=>[l(i,{modelValue:r(n).deptId,"onUpdate:modelValue":e[8]||(e[8]=o=>r(n).deptId=o),placeholder:"è¯·è¾“å…¥éƒ¨é—¨ç¼–ç ",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[l(d,{label:"éƒ¨é—¨åç§°",prop:"deptName"},{default:t(()=>[l(i,{modelValue:r(n).deptName,"onUpdate:modelValue":e[9]||(e[9]=o=>r(n).deptName=o),placeholder:"è¯·è¾“å…¥éƒ¨é—¨åç§°",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(I,null,{default:t(()=>[l(c,{xs:{span:24},sm:{span:24}},{default:t(()=>[l(d,{label:"éƒ¨é—¨ä¸Šçº§",prop:"parentId"},{default:t(()=>[l(Ve,{placeholder:"è¯·é€‰æ‹©éƒ¨é—¨ä¸Šçº§",modelValue:r(n).parentId,"onUpdate:modelValue":e[10]||(e[10]=o=>r(n).parentId=o),options:r(A),props:{expandTrigger:"hover",emitPath:!1,checkStrictly:!0},filterable:"",clearable:"",style:{width:"540px"}},{default:t(({node:o,data:f})=>[ae("span",null,W(f.label),1),o.isLeaf?oe("",!0):(g(),te("span",ze," ("+W(f.children.length)+") ",1))]),_:1},8,["modelValue","options"])]),_:1})]),_:1})]),_:1}),l(I,null,{default:t(()=>[l(c,{xs:{span:24},sm:{span:12}},{default:t(()=>[l(d,{label:"éƒ¨é—¨çŠ¶æ€",prop:"deptStatus"},{default:t(()=>[l(Z,{modelValue:r(n).deptStatus,"onUpdate:modelValue":e[11]||(e[11]=o=>r(n).deptStatus=o),placeholder:"è¯·é€‰æ‹©éƒ¨é—¨çŠ¶æ€",style:{width:"260px"},clearable:""},{default:t(()=>[l(E,{label:"å¯ç”¨",value:"0"}),l(E,{label:"åœç”¨",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[l(d,{label:"è´Ÿè´£äºº",prop:"leader"},{default:t(()=>[l(i,{modelValue:r(n).leader,"onUpdate:modelValue":e[12]||(e[12]=o=>r(n).leader=o),placeholder:"è¯·è¾“å…¥éƒ¨é—¨è´Ÿè´£äºº",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(I,null,{default:t(()=>[l(c,{xs:{span:24},sm:{span:12}},{default:t(()=>[l(d,{label:"æ‰‹æœºå·ç ",prop:"phone"},{default:t(()=>[l(i,{modelValue:r(n).phone,"onUpdate:modelValue":e[13]||(e[13]=o=>r(n).phone=o),placeholder:"è¯·è¾“å…¥æ‰‹æœºå·ç ",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[l(d,{label:"é‚®ç®±åœ°å€",prop:"email"},{default:t(()=>[l(i,{modelValue:r(n).email,"onUpdate:modelValue":e[14]||(e[14]=o=>r(n).email=o),placeholder:"è¯·è¾“å…¥é‚®ç®±åœ°å€",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(I,null,{default:t(()=>[l(c,{xs:{span:24},sm:{span:12}},{default:t(()=>[l(d,{label:"æ˜¾ç¤ºæŽ’åº",prop:"sorted"},{default:t(()=>[l(we,{modelValue:r(n).sorted,"onUpdate:modelValue":e[15]||(e[15]=o=>r(n).sorted=o),style:{width:"260px"},clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:t(()=>[l(d,{label:"å¤‡æ³¨",prop:"remark"},{default:t(()=>[l(i,{modelValue:r(n).remark,"onUpdate:modelValue":e[16]||(e[16]=o=>r(n).remark=o),placeholder:"è¯·è¾“å…¥å¤‡æ³¨",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"]),V(" "+W(r(n)),1)]),_:1},8,["title","loading"])]),_:1,__:[23]})])}}});export{Ge as default};
