import{af as S,d as oe,r,o as Ie,I,a as De,g as i,S as A,e as R,i as d,f as t,w as o,Q as p,j as J,D as $,F as Z,l as ee,y,k,R as te,z as u,t as Ne,U as h,H as le,T as U,V as O,W as q,X as Ue}from"./index-_hVn5I9W.js";const Be=s=>S.get("/koi/sysNotice/listPage",s),Ke=s=>S.get("/koi/sysNotice/getById/"+s),Me=s=>S.post("/koi/sysNotice/update",s),ze=s=>S.post("/koi/sysNotice/add",s),Ae=s=>S.post("/koi/sysNotice/deleteById/"+s),Le=s=>S.post("/koi/sysNotice/batchDelete",s),Pe=(s,L)=>S.post("/koi/sysNotice/updateStatus/"+s+"/"+L),Ye={class:"koi-flex"},Ee=oe({name:"noticePage"}),$e=oe({...Ee,setup(s){const L=r(!1),P=r(!0),F=r([{noticeId:3,noticeTitle:"ElementPlus全新经典UI🌻",noticeType:"2",noticeContent:"走过路过，千万不要错过🌻",noticeStatus:"0",sorted:3,createBy:"YU-ADMIN🌻",createTime:"2023-08-22 11:27:24",updateBy:"",updateTime:"2023-08-16 18:36:50",remark:"YU-ADMIN🌻"},{noticeId:2,noticeTitle:"维护通知：2023-11-23 YU-ADMIN将持续进行维护",noticeType:"2",noticeContent:"维护内容",noticeStatus:"0",sorted:2,createBy:"YU-ADMIN🌻",createTime:"2023-08-22 11:27:24",updateBy:"",updateTime:null,remark:"YU-ADMIN🌻"},{noticeId:1,noticeTitle:"温馨提醒：2023-11-23 YU-ADMIN生日",noticeType:"1",noticeContent:"新版本内容",noticeStatus:"0",sorted:1,createBy:"YU-ADMIN🌻",createTime:"2023-08-22 11:27:24",updateBy:"",updateTime:null,remark:"YU-ADMIN🌻"}]),c=r({pageNo:1,pageSize:10,noticeTitle:"",noticeStatus:"",noticeType:""}),B=r(0),ae=()=>{c.value={pageNo:1,pageSize:10,noticeTitle:"",noticeStatus:"",noticeType:""}},ne=()=>{console.log("搜索"),c.value.pageNo=1,w()},ie=()=>{console.log("重置搜索"),ae(),m()},m=async()=>{B.value=100},w=async()=>{try{const a=await Be(c.value);console.log("公告数据表格数据->",a.data),F.value=a.data.records,B.value=a.data.total}catch(a){console.log(a),h("数据查询失败，请刷新重试🌻")}};Ie(()=>{m(),se()});const K=r(),se=async()=>{try{K.value=[{dictLabel:"通知",dictValue:"1",dictTag:"primary",dictColor:""},{dictLabel:"公告",dictValue:"2",dictTag:"warning",dictColor:""}]}catch(a){console.log(a),I("数据字典查询失败，请刷新重试🌻")}},D=r([]),Q=r(!0),j=r(!0),re=a=>{D.value=a.map(e=>e.noticeId),Q.value=a.length!=1,j.value=!a.length},ue=()=>{N(),Y.value="公告添加",n.value.noticeStatus="0",V.value.koiOpen(),le("添加🌻")},ce=async a=>{if(console.log("回显数据ID",a),a==null||a==""){q("请选择需要修改的数据🌻");return}try{const e=await Ke(a);console.log(e.data),n.value=e.data}catch(e){h("数据获取失败，请刷新重试🌻"),console.log(e)}},W=async a=>{N(),Y.value="公告修改";const e=a?a.noticeId:D.value[0];(e==null||e=="")&&I("请选中需要修改的数据🌻"),console.log(e),ce(e),V.value.koiOpen(),le("修改🌻")},V=r(),Y=r("公告类型管理"),E=r();let n=r({noticeTitle:null,noticeType:null,noticeStatus:null,noticeContent:null,sorted:1,remark:null});const N=()=>{n.value={noticeTitle:null,noticeType:null,noticeStatus:null,noticeContent:null,sorted:1,remark:null}},de=De({noticeTitle:[{required:!0,message:"请输入公告名称",trigger:"blur"}],noticeType:[{required:!0,message:"请输入公告类型",trigger:"blur"}],noticeStatus:[{required:!0,message:"请输入选择公告状态",trigger:"blur"}]}),T=r(!1),pe=()=>{E.value&&(T.value=!0,E.value.validate(async a=>{if(a)if(console.log("表单ID",n.value.noticeId),n.value.noticeId!=null&&n.value.noticeId!="")try{await Me(n.value),U("修改成功🌻"),T.value=!1,V.value.koiQuickClose(),N(),m()}catch(e){console.log(e),T.value=!1,h("修改失败，请刷新重试🌻")}else try{await ze(n.value),U("添加成功🌻"),T.value=!1,V.value.koiQuickClose(),N(),m()}catch(e){console.log(e),T.value=!1,h("添加失败，请刷新重试🌻")}else I("验证失败，请检查填写内容🌻"),T.value=!1}))},me=()=>{V.value.koiClose()},ge=a=>{let e=a.noticeStatus==="0"?"启用":"停用";O("确认要["+e+"]-["+a.noticeTitle+"]吗？").then(async()=>{if(N(),!a.noticeId||!a.noticeStatus){q("请选择需要修改的数据🌻");return}try{await Pe(a.noticeId,a.noticeStatus),U("修改成功🌻")}catch(_){console.log(_),w(),h("修改失败，请刷新重试🌻")}}).catch(()=>{I("已取消🌻")})},ve=a=>{const e=a.noticeId;if(e==null||e==""){q("请选中需要删除的数据🌻");return}O("您确认需要删除公告名称["+a.noticeTitle+"]么？").then(async()=>{try{await Ae(e),w(),U("删除成功🌻")}catch(_){console.log(_),w(),h("删除失败，请刷新重试🌻")}}).catch(()=>{I("已取消🌻")})},fe=()=>{if(D.value.length==0){Ue("请选择需要删除的数据🌻");return}O("您确认需要进行批量删除么？").then(async()=>{try{console.log("ids",D.value),await Le(D.value),w(),U("批量删除成功🌻")}catch(a){console.log(a),w(),h("批量删除失败，请刷新重试🌻")}}).catch(()=>{I("已取消🌻")})};return(a,e)=>{const _=i("el-input"),g=i("el-form-item"),C=i("el-option"),M=i("el-select"),b=i("el-button"),H=i("el-form"),v=i("el-col"),ye=i("KoiToolbar"),X=i("el-row"),f=i("el-table-column"),_e=i("KoiTag"),be=i("el-switch"),G=i("el-tooltip"),Te=i("el-table"),ke=i("el-pagination"),he=i("el-input-number"),Se=i("KoiDrawer"),we=i("KoiCard"),Ve=A("debounce"),Ce=A("throttle"),x=A("auth"),xe=A("loading");return d(),R("div",Ye,[t(we,null,{default:o(()=>[p(t(H,{inline:!0},{default:o(()=>[t(g,{label:"公告标题",prop:"noticeTitle"},{default:o(()=>[t(_,{placeholder:"请输入公告标题",modelValue:c.value.noticeTitle,"onUpdate:modelValue":e[0]||(e[0]=l=>c.value.noticeTitle=l),clearable:"",style:{width:"240px"},onKeyup:$(m,["enter","native"])},null,8,["modelValue"])]),_:1}),t(g,{label:"公告类型",prop:"noticeType"},{default:o(()=>[t(M,{placeholder:"请选择公告类型",modelValue:c.value.noticeType,"onUpdate:modelValue":e[1]||(e[1]=l=>c.value.noticeType=l),style:{width:"240px"},onKeyup:$(m,["enter","native"]),clearable:""},{default:o(()=>[(d(!0),R(Z,null,ee(K.value,l=>(d(),y(C,{key:l.dictValue,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(g,{label:"公告状态",prop:"noticeStatus"},{default:o(()=>[t(M,{placeholder:"请选择公告状态",modelValue:c.value.noticeStatus,"onUpdate:modelValue":e[2]||(e[2]=l=>c.value.noticeStatus=l),clearable:"",style:{width:"240px"},onKeyup:$(m,["enter","native"])},{default:o(()=>[t(C,{label:"启用",value:"0"}),t(C,{label:"停用",value:"1"})]),_:1},8,["modelValue"])]),_:1}),t(g,null,{default:o(()=>[p((d(),y(b,{type:"primary",icon:"search",plain:""},{default:o(()=>e[15]||(e[15]=[k("搜索")])),_:1,__:[15]})),[[Ve,ne]]),p((d(),y(b,{type:"danger",icon:"refresh",plain:""},{default:o(()=>e[16]||(e[16]=[k("重置")])),_:1,__:[16]})),[[Ce,ie]])]),_:1})]),_:1},512),[[te,P.value]]),t(X,{gutter:10},{default:o(()=>[p((d(),y(v,{span:1.5},{default:o(()=>[t(b,{type:"primary",icon:"plus",plain:"",onClick:e[3]||(e[3]=l=>ue())},{default:o(()=>e[17]||(e[17]=[k("新增")])),_:1,__:[17]})]),_:1})),[[x,["system:role:add"]]]),p((d(),y(v,{span:1.5},{default:o(()=>[t(b,{type:"success",icon:"edit",plain:"",onClick:e[4]||(e[4]=l=>W()),disabled:Q.value},{default:o(()=>e[18]||(e[18]=[k("修改")])),_:1,__:[18]},8,["disabled"])]),_:1})),[[x,["system:role:update"]]]),p((d(),y(v,{span:1.5},{default:o(()=>[t(b,{type:"danger",icon:"delete",plain:"",onClick:e[5]||(e[5]=l=>fe()),disabled:j.value},{default:o(()=>e[19]||(e[19]=[k("删除")])),_:1,__:[19]},8,["disabled"])]),_:1})),[[x,["system:role:delete"]]]),p((d(),y(v,{span:1.5},{default:o(()=>[t(b,{type:"warning",icon:"download",plain:""},{default:o(()=>e[20]||(e[20]=[k("导出")])),_:1,__:[20]})]),_:1})),[[x,["system:role:export"]]]),t(ye,{showSearch:P.value,"onUpdate:showSearch":e[6]||(e[6]=l=>P.value=l),onRefreshTable:m},null,8,["showSearch"])]),_:1}),e[21]||(e[21]=J("br",null,null,-1)),p((d(),y(Te,{border:"",data:F.value,"empty-text":"暂时没有数据哟🌻",onSelectionChange:re},{default:o(()=>[t(f,{type:"selection",width:"55",align:"center"}),t(f,{label:"序号",prop:"noticeId",width:"120px",align:"center",type:"index"}),t(f,{label:"公告名称",prop:"noticeTitle",width:"260px",align:"center","show-overflow-tooltip":!0}),t(f,{label:"公告类型",prop:"noticeType",width:"100px",align:"center"},{default:o(l=>[t(_e,{tagOptions:K.value,value:l.row.noticeType},null,8,["tagOptions","value"])]),_:1}),t(f,{label:"公告状态",prop:"noticeStatus",width:"100px",align:"center"},{default:o(l=>[t(be,{modelValue:l.row.noticeStatus,"onUpdate:modelValue":z=>l.row.noticeStatus=z,"active-text":"启用","inactive-text":"停用","active-value":"0","inactive-value":"1","inline-prompt":!0,onChange:z=>ge(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(f,{label:"公告备注",prop:"remark",width:"260px",align:"center","show-overflow-tooltip":!0}),t(f,{label:"创建时间",prop:"createTime",width:"180px",align:"center"}),t(f,{label:"修改时间",prop:"updateTime",width:"180px",align:"center"}),t(f,{label:"修改人",prop:"updateBy",width:"180px",align:"center"}),t(f,{label:"操作",align:"center",width:"120",fixed:"right"},{default:o(({row:l})=>[t(G,{content:"修改🌻",placement:"top"},{default:o(()=>[p(t(b,{type:"primary",icon:"Edit",circle:"",plain:"",onClick:z=>W(l)},null,8,["onClick"]),[[x,["system:role:update"]]])]),_:2},1024),t(G,{content:"删除🌻",placement:"top"},{default:o(()=>[p(t(b,{type:"danger",icon:"Delete",circle:"",plain:"",onClick:z=>ve(l)},null,8,["onClick"]),[[x,["system:role:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[xe,L.value]]),e[22]||(e[22]=J("br",null,null,-1)),p(t(ke,{background:"","current-page":c.value.pageNo,"onUpdate:currentPage":e[7]||(e[7]=l=>c.value.pageNo=l),"page-size":c.value.pageSize,"onUpdate:pageSize":e[8]||(e[8]=l=>c.value.pageSize=l),"page-sizes":[10,20,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:B.value,onSizeChange:m,onCurrentChange:m},null,8,["current-page","page-size","total"]),[[te,B.value>0]]),t(Se,{ref_key:"koiDrawerRef",ref:V,title:Y.value,onKoiConfirm:pe,onKoiCancel:me,loading:T.value},{content:o(()=>[t(H,{ref_key:"formRef",ref:E,rules:de,model:u(n),"label-width":"80px","status-icon":""},{default:o(()=>[t(X,null,{default:o(()=>[t(v,{xs:{span:24},sm:{span:24}},{default:o(()=>[t(g,{label:"公告名称",prop:"noticeTitle"},{default:o(()=>[t(_,{modelValue:u(n).noticeTitle,"onUpdate:modelValue":e[9]||(e[9]=l=>u(n).noticeTitle=l),placeholder:"请输入公告名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(v,{xs:{span:24},sm:{span:24}},{default:o(()=>[t(g,{label:"公告类型",prop:"noticeType"},{default:o(()=>[t(M,{placeholder:"请选择公告类型",modelValue:u(n).noticeType,"onUpdate:modelValue":e[10]||(e[10]=l=>u(n).noticeType=l),clearable:""},{default:o(()=>[(d(!0),R(Z,null,ee(K.value,l=>(d(),y(C,{key:l.dictValue,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(v,{xs:{span:24},sm:{span:24}},{default:o(()=>[t(g,{label:"公告状态",prop:"noticeStatus"},{default:o(()=>[t(M,{modelValue:u(n).noticeStatus,"onUpdate:modelValue":e[11]||(e[11]=l=>u(n).noticeStatus=l),placeholder:"请选择公告状态",clearable:""},{default:o(()=>[t(C,{label:"启用",value:"0"}),t(C,{label:"停用",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(v,{xs:{span:24},sm:{span:24}},{default:o(()=>[t(g,{label:"公告内容",prop:"noticeContent"},{default:o(()=>[t(_,{modelValue:u(n).noticeContent,"onUpdate:modelValue":e[12]||(e[12]=l=>u(n).noticeContent=l),placeholder:"请输入公告内容",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(v,{xs:{span:24},sm:{span:24}},{default:o(()=>[t(g,{label:"排序",prop:"sorted"},{default:o(()=>[t(he,{modelValue:u(n).sorted,"onUpdate:modelValue":e[13]||(e[13]=l=>u(n).sorted=l),min:0,step:1,placeholder:"请输入数字"},null,8,["modelValue"])]),_:1})]),_:1}),t(v,{xs:{span:24},sm:{span:24}},{default:o(()=>[t(g,{label:"公告备注",prop:"remark"},{default:o(()=>[t(_,{modelValue:u(n).remark,"onUpdate:modelValue":e[14]||(e[14]=l=>u(n).remark=l),rows:5,type:"textarea",placeholder:"请输入公告备注"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"]),k(" "+Ne(u(n)),1)]),_:1},8,["title","loading"])]),_:1,__:[21,22]})])}}});export{$e as default};
