import{af as C,d as B,r as d,o as ne,g as a,S as f,e as se,i as c,f as o,w as l,Q as p,j as P,D as k,y as b,k as y,R as U,t as ie,W as re,V as M,T,U as x,I as z,X as de,ah as pe}from"./index-_hVn5I9W.js";const ue=u=>C.get("/koi/sysLoginLog/listPage",u),ge=u=>C.post("/koi/sysLoginLog/deleteById/"+u),ce=u=>C.post("/koi/sysLoginLog/batchDelete",u),me={class:"koi-flex"},_e=B({name:"loginlogPage"}),he=B({..._e,setup(u){const K=d(!1),S=d(!0),D=d([{loginId:1,loginName:"YU-ADMIN🌻",ipAddress:"127.0.0.1",loginAddress:"河南省 郑州市",loginStatus:"0",deviceName:"PC",browser:"Chrome 11",os:"Windows 10",message:"YU-ADMIN🌻",loginTime:"2023-08-08 23:00:00"},{loginId:2,loginName:"张大仙🌻",ipAddress:"127.0.0.1",loginAddress:"河南省 郑州市",loginStatus:"0",deviceName:"PC",browser:"Chrome 11",os:"Windows 10",message:"YU-ADMIN🌻",loginTime:"2023-08-08 23:00:00"},{loginId:3,loginName:"王将🌻",ipAddress:"127.0.0.1",loginAddress:"河南省 郑州市",loginStatus:"0",deviceName:"PC",browser:"Chrome 11",os:"Windows 10",message:"YU-ADMIN🌻",loginTime:"2023-08-08 23:00:00"}]),s=d({pageNo:1,pageSize:10,loginName:"",ipAddress:"",loginStatus:""}),m=d(0),_=d(),L=()=>{_.value=[],s.value={pageNo:1,pageSize:10,loginName:"",ipAddress:"",loginStatus:""}},Y=()=>{console.log("搜索"),s.value.pageNo=1,r()},W=()=>{console.log("重置搜索"),L(),r()},r=async()=>{m.value=200},v=async()=>{try{const n=await ue(pe(s.value,_.value));console.log("日志数据表格数据->",n.data),D.value=n.data.records,m.value=n.data.total}catch(n){console.log(n),x("数据查询失败，请刷新重试🌻")}};ne(()=>{r()});const N=d([]),E=d(!0),A=d(!0),R=n=>{N.value=n.map(e=>e.loginId),E.value=n.length!=1,A.value=!n.length},j=n=>{const e=n.loginId;if(e==null||e==""){re("请选中需要删除的数据🌻");return}M("您确认需要删除用户名称["+n.loginName+"]么？").then(async()=>{try{await ge(e),v(),T("删除成功🌻")}catch(w){console.log(w),v(),x("删除失败，请刷新重试🌻")}}).catch(()=>{z("已取消🌻")})},H=()=>{if(N.value.length==0){de("请选择需要删除的数据🌻");return}M("您确认需要进行批量删除么？").then(async()=>{try{await ce(N.value),v(),T("批量删除成功🌻")}catch(n){console.log(n),x("批量删除失败，请刷新重试🌻"),v()}}).catch(()=>{z("已取消🌻")})};return(n,e)=>{const w=a("el-input"),g=a("el-form-item"),I=a("el-option"),$=a("el-select"),Q=a("el-date-picker"),h=a("el-button"),X=a("el-form"),q=a("el-col"),F=a("KoiToolbar"),G=a("el-row"),i=a("el-table-column"),J=a("el-tag"),O=a("el-tooltip"),Z=a("el-table"),ee=a("el-pagination"),oe=a("KoiCard"),te=f("debounce"),le=f("throttle"),V=f("auth"),ae=f("loading");return c(),se("div",me,[o(oe,null,{default:l(()=>[p(o(X,{inline:!0},{default:l(()=>[o(g,{label:"用户名称",prop:"loginName"},{default:l(()=>[o(w,{placeholder:"请输入用户名称",modelValue:s.value.loginName,"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.loginName=t),style:{width:"200px"},clearable:"",onKeyup:k(r,["enter","native"])},null,8,["modelValue"])]),_:1}),o(g,{label:"IP地址",prop:"ipAddress"},{default:l(()=>[o(w,{placeholder:"请输入IP地址",modelValue:s.value.ipAddress,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.ipAddress=t),style:{width:"200px"},clearable:"",onKeyup:k(r,["enter","native"])},null,8,["modelValue"])]),_:1}),o(g,{label:"登录状态",prop:"loginStatus"},{default:l(()=>[o($,{placeholder:"请选择日志状态",modelValue:s.value.loginStatus,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.loginStatus=t),style:{width:"200px"},clearable:"",onKeyup:k(r,["enter","native"])},{default:l(()=>[o(I,{label:"登录成功",value:"0"}),o(I,{label:"登录失败",value:"1"})]),_:1},8,["modelValue"])]),_:1}),o(g,{label:"访问时间",prop:"loginTime"},{default:l(()=>[o(Q,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=t=>_.value=t),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":"开始日期","range-separator":"至","end-placeholder":"结束日期","default-time":[new Date(2e3,1,1,0,0,0),new Date(2e3,1,1,23,59,59)]},null,8,["modelValue","default-time"])]),_:1}),o(g,null,{default:l(()=>[p((c(),b(h,{type:"primary",icon:"search",plain:""},{default:l(()=>e[8]||(e[8]=[y("搜索")])),_:1,__:[8]})),[[te,Y]]),p((c(),b(h,{type:"danger",icon:"refresh",plain:""},{default:l(()=>e[9]||(e[9]=[y("重置")])),_:1,__:[9]})),[[le,W]])]),_:1})]),_:1},512),[[U,S.value]]),o(G,{gutter:10},{default:l(()=>[p((c(),b(q,{span:1.5},{default:l(()=>[o(h,{type:"danger",icon:"delete",plain:"",onClick:e[4]||(e[4]=t=>H()),disabled:A.value},{default:l(()=>e[10]||(e[10]=[y("删除")])),_:1,__:[10]},8,["disabled"])]),_:1})),[[V,["system:role:delete"]]]),o(F,{showSearch:S.value,"onUpdate:showSearch":e[5]||(e[5]=t=>S.value=t),onRefreshTable:r},null,8,["showSearch"])]),_:1}),e[11]||(e[11]=P("br",null,null,-1)),p((c(),b(Z,{border:"",data:D.value,"empty-text":"暂时没有数据哟🌻",onSelectionChange:R},{default:l(()=>[o(i,{type:"selection",width:"55",align:"center"}),o(i,{label:"序号",prop:"loginId",width:"80px",align:"center",type:"index"}),o(i,{label:"登录用户",prop:"loginName",width:"130px",align:"center","show-overflow-tooltip":!0}),o(i,{label:"IP地址",prop:"ipAddress",width:"160px",align:"center","show-overflow-tooltip":!0}),o(i,{label:"登录地址",prop:"loginAddress",width:"260px",align:"center","show-overflow-tooltip":!0}),o(i,{label:"登录状态",prop:"loginStatus",width:"100px",align:"center","show-overflow-tooltip":!0},{default:l(t=>[o(J,{type:t.row.loginStatus=="0"?"primary":t.row.loginStatus=="1"?"danger":"warning"},{default:l(()=>[y(ie(t.row.loginStatus=="0"?"登录成功":t.row.loginStatus=="1"?"登录失败":"未知状态"),1)]),_:2},1032,["type"])]),_:1}),o(i,{label:"设备名称",prop:"deviceName",width:"150px",align:"center","show-overflow-tooltip":!0}),o(i,{label:"浏览器",prop:"browser",width:"150px",align:"center","show-overflow-tooltip":!0}),o(i,{label:"操作系统",prop:"os",width:"150px",align:"center","show-overflow-tooltip":!0}),o(i,{label:"登录信息",prop:"message",width:"150px",align:"center","show-overflow-tooltip":!0}),o(i,{label:"登录时间",prop:"loginTime",width:"180px",align:"center"}),o(i,{label:"操作",align:"center",width:"120",fixed:"right"},{default:l(({row:t})=>[o(O,{content:"删除🌻",placement:"top"},{default:l(()=>[p(o(h,{type:"danger",icon:"Delete",circle:"",plain:"",onClick:ve=>j(t)},null,8,["onClick"]),[[V,["system:role:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ae,K.value]]),e[12]||(e[12]=P("br",null,null,-1)),p(o(ee,{background:"","current-page":s.value.pageNo,"onUpdate:currentPage":e[6]||(e[6]=t=>s.value.pageNo=t),"page-size":s.value.pageSize,"onUpdate:pageSize":e[7]||(e[7]=t=>s.value.pageSize=t),"page-sizes":[10,20,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:m.value,onSizeChange:r,onCurrentChange:r},null,8,["current-page","page-size","total"]),[[U,m.value>0]])]),_:1,__:[11,12]})])}}});export{he as default};
