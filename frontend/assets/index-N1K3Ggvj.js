import{d as G,r as p,a as F,c as U,o as K,b as L,e as _,f as a,w as o,g as v,h as M,u as q,i as y,j as s,t as l,k as r,F as H,l as J,m as S,_ as O}from"./index-_hVn5I9W.js";const Q={class:"p-4px"},W={class:"chart-container"},X={class:"resource-info"},Y={class:"progress-content"},Z={class:"resource-details"},ss={class:"chart-container"},es={class:"resource-info"},ts={class:"progress-content"},os={class:"resource-details"},as={class:"disk-usage"},ls={class:"disk-header"},rs={class:"server-status"},ns={class:"status-item"},us={key:0,class:"status-item"},ds={key:1,class:"status-item"},is={class:"status-buttons"},cs=G({__name:"index",setup(ps){const N=q(),h=p(0),b=p(0),d=F({cores:0,loadAvg:[0,0,0]}),n=F({total:0,used:0,free:0,available:0}),x=p([]),m=p("未运行"),C=p(0),B=p("0分钟"),V=U(()=>w(h.value)),T=U(()=>w(b.value));function w(t){return t<60?"#67C23A":t<80?"#E6A23C":"#F56C6C"}function $(t){return w(t)}function k(t,e=2){if(t===0)return"0 B";const u=1024,g=e<0?0:e,i=["B","KB","MB","GB","TB","PB"],f=Math.floor(Math.log(t)/Math.log(u));return parseFloat((t/Math.pow(u,f)).toFixed(g))+" "+i[f]}async function I(){try{const{data:t}=await M.get("/api/system/resources");t.success&&(h.value=parseInt(t.cpu.usage),d.cores=t.cpu.cores,d.loadAvg=t.cpu.loadAvg,b.value=parseInt(t.memory.usagePercent),n.total=t.memory.total,n.used=t.memory.used,n.free=t.memory.free,n.available=t.memory.available,x.value=t.disk)}catch(t){console.error("获取系统资源信息失败:",t)}}async function A(){try{const{data:t}=await M.get("/api/status");m.value=t.status,C.value=t.players||0,B.value=t.uptime||"0分钟"}catch(t){console.error("获取服务器状态失败:",t)}}function z(){N.push("/terraria/server")}let P;return K(()=>{I(),A(),P=setInterval(()=>{I(),A()},5e3)}),L(()=>{clearInterval(P)}),(t,e)=>{const u=v("el-card"),g=v("el-progress"),i=v("el-col"),f=v("el-row"),D=v("el-tag"),E=v("el-button");return y(),_("div",Q,[a(u,{class:"rounded-md dark:bg-black",shadow:"hover"},{default:o(()=>e[0]||(e[0]=[s("div",{class:"card-header"},[s("h2",null,"泰拉瑞亚服务器控制系统"),s("p",null,"系统资源监控")],-1)])),_:1,__:[0]}),a(f,{gutter:20,class:"m-t-20px"},{default:o(()=>[a(i,{span:12,lg:12,md:12,sm:24,xs:24},{default:o(()=>[a(u,{class:"rounded-md dark:bg-black",shadow:"hover"},{header:o(()=>e[1]||(e[1]=[s("div",{class:"card-header"},[s("span",null,"CPU 使用率")],-1)])),default:o(()=>[s("div",W,[s("div",X,[a(g,{type:"dashboard",percentage:h.value,color:V.value,"stroke-width":14,width:200},{default:o(()=>[s("div",Y,[s("h3",null,l(h.value)+"%",1),e[2]||(e[2]=s("p",null,"CPU使用率",-1))])]),_:1},8,["percentage","color"])]),s("div",Z,[s("p",null,[e[3]||(e[3]=s("strong",null,"系统内核数:",-1)),r(" "+l(d.cores),1)]),s("p",null,[e[4]||(e[4]=s("strong",null,"1分钟负载:",-1)),r(" "+l(d.loadAvg[0]),1)]),s("p",null,[e[5]||(e[5]=s("strong",null,"5分钟负载:",-1)),r(" "+l(d.loadAvg[1]),1)]),s("p",null,[e[6]||(e[6]=s("strong",null,"15分钟负载:",-1)),r(" "+l(d.loadAvg[2]),1)])])])]),_:1})]),_:1}),a(i,{span:12,lg:12,md:12,sm:24,xs:24},{default:o(()=>[a(u,{class:"rounded-md dark:bg-black",shadow:"hover"},{header:o(()=>e[7]||(e[7]=[s("div",{class:"card-header"},[s("span",null,"内存使用情况")],-1)])),default:o(()=>[s("div",ss,[s("div",es,[a(g,{type:"dashboard",percentage:b.value,color:T.value,"stroke-width":14,width:200},{default:o(()=>[s("div",ts,[s("h3",null,l(b.value)+"%",1),e[8]||(e[8]=s("p",null,"内存使用率",-1))])]),_:1},8,["percentage","color"])]),s("div",os,[s("p",null,[e[9]||(e[9]=s("strong",null,"总内存:",-1)),r(" "+l(k(n.total)),1)]),s("p",null,[e[10]||(e[10]=s("strong",null,"已使用:",-1)),r(" "+l(k(n.used)),1)]),s("p",null,[e[11]||(e[11]=s("strong",null,"空闲:",-1)),r(" "+l(k(n.free)),1)]),s("p",null,[e[12]||(e[12]=s("strong",null,"可用:",-1)),r(" "+l(k(n.available)),1)])])])]),_:1})]),_:1})]),_:1}),a(f,{gutter:20,class:"m-t-20px"},{default:o(()=>[a(i,{span:12,lg:12,md:12,sm:24,xs:24},{default:o(()=>[a(u,{class:"rounded-md dark:bg-black",shadow:"hover"},{header:o(()=>e[13]||(e[13]=[s("div",{class:"card-header"},[s("span",null,"磁盘使用情况")],-1)])),default:o(()=>[s("div",as,[(y(!0),_(H,null,J(x.value,(c,R)=>(y(),_("div",{key:R,class:"disk-item"},[s("div",ls,[s("span",null,l(c.filesystem)+" ("+l(c.mountpoint)+")",1)]),a(g,{percentage:parseFloat(c.usedPercent),format:j=>`${j}% - ${c.used}/${c.size}`,color:$(parseFloat(c.usedPercent))},null,8,["percentage","format","color"])]))),128))])]),_:1})]),_:1}),a(i,{span:12,lg:12,md:12,sm:24,xs:24},{default:o(()=>[a(u,{class:"rounded-md dark:bg-black",shadow:"hover"},{header:o(()=>e[14]||(e[14]=[s("div",{class:"card-header"},[s("span",null,"泰拉瑞亚服务器状态")],-1)])),default:o(()=>[s("div",rs,[s("div",ns,[e[15]||(e[15]=s("span",{class:"status-label"},"状态:",-1)),a(D,{type:m.value==="运行中"?"success":"warning"},{default:o(()=>[r(l(m.value),1)]),_:1},8,["type"])]),m.value==="运行中"?(y(),_("div",us,[e[16]||(e[16]=s("span",{class:"status-label"},"在线玩家:",-1)),s("span",null,l(C.value),1)])):S("",!0),m.value==="运行中"?(y(),_("div",ds,[e[17]||(e[17]=s("span",{class:"status-label"},"运行时间:",-1)),s("span",null,l(B.value),1)])):S("",!0),s("div",is,[a(E,{type:"primary",onClick:z},{default:o(()=>e[18]||(e[18]=[r("服务器管理")])),_:1,__:[18]})])])]),_:1})]),_:1})]),_:1})])}}}),ms=O(cs,[["__scopeId","data-v-6def4e65"]]);export{ms as default};
