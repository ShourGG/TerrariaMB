import{d as le,r as u,o as De,a as Ue,g as s,S as P,e as Me,i as g,f as l,w as a,Q as d,j as Q,D as j,y as h,k,R as ee,z as f,t as Re,T as C,I as x,U as N,V as W,W as $,X as ze,ag as Te}from"./index-_hVn5I9W.js";import{u as Be,a as Pe,b as $e,d as Ee,c as Le,l as Oe,g as qe}from"./index-DiRUQRLM.js";import{h as Ae,i as Qe,s as je}from"./index-Ug9vwzts.js";const We={class:"koi-flex"},Xe=le({name:"rolePage"}),Ge=le({...Xe,setup(Ye){const ae=u(!1),E=u(!0),X=u([{roleId:1,roleName:"YU-ADMINðŸŒ»",roleCode:"YU-ADMIN",roleStatus:"0",sorted:1,remark:"è¶…çº§ç®¡ç†å‘˜",createTime:"2023-08-08 23:00:00"},{roleId:2,roleName:"å¼ å¤§ä»™",roleCode:"ZDX",roleStatus:"0",sorted:2,remark:"è™Žç‰™688ï¼Œæ¯æ™šä¸ƒç‚¹åŠï¼Œä¸è§ä¸æ•£ï¼",createTime:"2023-08-08 23:00:00"},{roleId:3,roleName:"èœé¸¡",roleCode:"COMMON",roleStatus:"1",sorted:3,remark:"å¹²é¥­",createTime:"2023-08-08 23:00:00"}]),p=u({pageNo:1,pageSize:10,roleName:"",roleStatus:"",roleCode:""}),z=u(0),oe=()=>{p.value={pageNo:1,pageSize:10,roleName:"",roleStatus:"",roleCode:""}},te=()=>{console.log("æœç´¢"),p.value.pageNo=1,v()},ne=()=>{console.log("é‡ç½®æœç´¢"),oe(),v()},v=async()=>{z.value=9},I=async()=>{try{const o=await Oe(p.value);console.log("è§’è‰²æ•°æ®è¡¨æ ¼æ•°æ®->",o.data),X.value=o.data.records,z.value=o.data.total}catch(o){console.log(o),N("æ•°æ®æŸ¥è¯¢å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}};De(()=>{v()});const V=u([]),L=u(!0),Y=u(!0),re=o=>{console.log(o),V.value=o.map(e=>e.roleId),L.value=o.length!=1,Y.value=!o.length},se=()=>{D(),K.value="è§’è‰²æ·»åŠ ",r.value.roleStatus="0",S.value.koiOpen(),C("æ·»åŠ ðŸŒ»")},ue=async o=>{if(o==null||o==""){$("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»");return}try{const e=await qe(o);console.log(e.data),r.value=e.data}catch(e){console.log(e),N("æ•°æ®èŽ·å–å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}},F=async o=>{D(),K.value="è§’è‰²ä¿®æ”¹";const e=o?o.roleId:V.value[0];(e==null||e=="")&&x("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»"),console.log(e),ue(e),S.value.koiOpen(),C("ä¿®æ”¹ðŸŒ»")},S=u(),K=u("è§’è‰²ç®¡ç†"),O=u();let r=u({roleId:null,roleName:null,roleCode:null,roleStatus:null,sorted:1,remark:null});const D=()=>{r.value={roleId:null,roleName:null,roleCode:null,roleStatus:null,sorted:1,remark:null}},de=Ue({roleName:[{required:!0,message:"è¯·è¾“å…¥è§’è‰²åå­—",trigger:"null"}],roleCode:[{required:!0,message:"è¯·è¾“å…¥è§’è‰²ç¼–å·",trigger:"null"}],roleStatus:[{required:!0,message:"è¯·è¾“å…¥é€‰æ‹©è§’è‰²çŠ¶æ€",trigger:"null"}],sorted:[{required:!0,message:"è¯·è¾“å…¥æŽ’åºå·",trigger:"null"}]}),_=u(!1),ie=()=>{O.value&&(_.value=!0,O.value.validate(async o=>{if(o)if(console.log("è¡¨å•ID",r.value.roleId),r.value.roleId!=null&&r.value.roleId!="")try{await Be(r.value),C("ä¿®æ”¹æˆåŠŸðŸŒ»"),_.value=!1,S.value.koiQuickClose(),D(),v()}catch(e){console.log(e),_.value=!1,N("ä¿®æ”¹å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}else try{await Pe(r.value),C("æ·»åŠ æˆåŠŸðŸŒ»"),_.value=!1,S.value.koiQuickClose(),D(),v()}catch(e){console.log(e),_.value=!1,N("æ·»åŠ å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}else x("éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥å¡«å†™å†…å®¹ðŸŒ»"),_.value=!1}))},pe=()=>{S.value.koiClose()},ce=o=>{let e=o.roleStatus==="0"?"å¯ç”¨":"åœç”¨";W("ç¡®è®¤è¦["+e+"]-["+o.roleName+"]è§’è‰²å—ï¼Ÿ").then(async()=>{if(D(),!o.roleId||!o.roleStatus){$("è¯·é€‰æ‹©éœ€è¦ä¿®æ”¹çš„æ•°æ®ðŸŒ»");return}try{await $e(o.roleId,o.roleStatus),C("ä¿®æ”¹æˆåŠŸðŸŒ»")}catch(i){console.log(i),I(),N("ä¿®æ”¹å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»")}}).catch(()=>{x("å·²å–æ¶ˆðŸŒ»")})},me=o=>{const e=o.roleId;if(e==null||e==""){$("è¯·é€‰ä¸­éœ€è¦åˆ é™¤çš„æ•°æ®ðŸŒ»");return}W("æ‚¨ç¡®è®¤éœ€è¦åˆ é™¤è§’è‰²åç§°["+o.roleName+"]ä¹ˆï¼Ÿ").then(async()=>{try{await Ee(e),I(),C("åˆ é™¤æˆåŠŸðŸŒ»")}catch(i){console.log(i),N("åˆ é™¤å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»"),I()}}).catch(()=>{x("å·²å–æ¶ˆðŸŒ»")})},fe=()=>{if(V.value.length==0){ze("è¯·é€‰æ‹©éœ€è¦åˆ é™¤çš„æ•°æ®ðŸŒ»");return}W("æ‚¨ç¡®è®¤éœ€è¦è¿›è¡Œæ‰¹é‡åˆ é™¤ä¹ˆï¼Ÿ").then(async()=>{try{await Le(V.value),I(),C("æ‰¹é‡åˆ é™¤æˆåŠŸðŸŒ»")}catch(o){console.log(o),N("æ‰¹é‡åˆ é™¤å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ðŸŒ»"),I()}}).catch(()=>{x("å·²å–æ¶ˆðŸŒ»")})},q=u(),U=u(),H=u([{menuId:1,menuName:"ç³»ç»Ÿç®¡ç†",children:[{menuId:4,menuName:"æ—¥å¿—ç®¡ç†",children:[{menuId:9,menuName:"ç™»å½•æ—¥å¿—"},{menuId:10,menuName:"æ“ä½œæ—¥å¿—"}]}]},{menuId:2,menuName:"ç›‘æŽ§ç®¡ç†",children:[{menuId:5,menuName:"Redisç›‘æŽ§"},{menuId:6,menuName:"æœåŠ¡å™¨ç›‘æŽ§"}]},{menuId:3,menuName:"èµ„æºç®¡ç†",children:[{menuId:7,menuName:"æ–‡ä»¶ç®¡ç†"},{menuId:8,menuName:"å›¾ç‰‡ç®¡ç†"}]}]),ve={id:"menuId",label:"menuName",children:"children"},Z=u(),M=u(),G=async o=>{var e,i;if(K.value="åˆ†é…èœå•ðŸŒ»",(e=U.value)==null||e.setCheckedKeys([],!1),M.value=(o==null?void 0:o.roleId)||V.value[0],M.value==null||M.value==""){$("è¯·é€‰ä¸­éœ€è¦åˆ†é…èœå•çš„æ•°æ®ðŸŒ»");return}q.value.koiOpen();try{const n=await Ae();H.value=Te(n.data.menuList,"menuId"),Z.value=n.data.spreadList}catch(n){console.log(n),x("èœå•èµ„æºåŠ è½½å¤±è´¥ðŸŒ»")}try{const n=await Qe(M.value);n.data&&((i=U.value)==null||i.setCheckedKeys(n.data,!1))}catch(n){console.log(n),x("è§’è‰²èœå•èµ„æºåŠ è½½å¤±è´¥ðŸŒ»")}},ge=async()=>{var n,w;_.value=!0;const o=(n=U.value)==null?void 0:n.getCheckedKeys(!1),i=((w=U.value)==null?void 0:w.getHalfCheckedKeys()).concat(o);try{await je(M.value,i),_.value=!1,C("è§’è‰²èœå•ä¿å­˜æˆåŠŸðŸŒ»"),window.location.reload}catch(T){console.log(T),x("è§’è‰²èœå•ä¿å­˜å¤±è´¥ðŸŒ»")}},_e=()=>{q.value.koiClose()};return(o,e)=>{const i=s("el-input"),n=s("el-form-item"),w=s("el-option"),T=s("el-select"),c=s("el-button"),J=s("el-form"),m=s("el-col"),ye=s("KoiToolbar"),B=s("el-row"),b=s("el-table-column"),he=s("el-switch"),A=s("el-tooltip"),ke=s("el-table"),be=s("el-pagination"),Ce=s("el-input-number"),xe=s("KoiDialog"),we=s("el-tree"),Ne=s("KoiDrawer"),Se=s("KoiCard"),Ie=P("throttle"),Ve=P("debounce"),y=P("auth"),Ke=P("loading");return g(),Me("div",We,[l(Se,null,{default:a(()=>[d(l(J,{inline:!0},{default:a(()=>[l(n,{label:"è§’è‰²åç§°",prop:"roleName"},{default:a(()=>[l(i,{placeholder:"è¯·è¾“å…¥è§’è‰²åç§°",modelValue:p.value.roleName,"onUpdate:modelValue":e[0]||(e[0]=t=>p.value.roleName=t),clearable:"",style:{width:"240px"},onKeyup:j(v,["enter","native"])},null,8,["modelValue"])]),_:1}),l(n,{label:"è§’è‰²çŠ¶æ€",prop:"roleStatus"},{default:a(()=>[l(T,{placeholder:"è¯·é€‰æ‹©è§’è‰²çŠ¶æ€",modelValue:p.value.roleStatus,"onUpdate:modelValue":e[1]||(e[1]=t=>p.value.roleStatus=t),clearable:"",style:{width:"240px"},onKeyup:j(v,["enter","native"])},{default:a(()=>[l(w,{label:"å¯ç”¨",value:"0"}),l(w,{label:"åœç”¨",value:"1"})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"è§’è‰²ç¼–å·",prop:"roleCode"},{default:a(()=>[l(i,{placeholder:"è¯·è¾“å…¥è§’è‰²ç¼–å·",modelValue:p.value.roleCode,"onUpdate:modelValue":e[2]||(e[2]=t=>p.value.roleCode=t),clearable:"",style:{width:"240px"},onKeyup:j(v,["enter","native"])},null,8,["modelValue"])]),_:1}),l(n,null,{default:a(()=>[d((g(),h(c,{type:"primary",icon:"search",plain:""},{default:a(()=>e[15]||(e[15]=[k("æœç´¢")])),_:1,__:[15]})),[[Ie,te]]),d((g(),h(c,{type:"danger",icon:"refresh",plain:""},{default:a(()=>e[16]||(e[16]=[k("é‡ç½®")])),_:1,__:[16]})),[[Ve,ne]])]),_:1})]),_:1},512),[[ee,E.value]]),l(B,{gutter:10},{default:a(()=>[d((g(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"primary",icon:"plus",plain:"",onClick:e[3]||(e[3]=t=>se())},{default:a(()=>e[17]||(e[17]=[k("æ–°å¢ž")])),_:1,__:[17]})]),_:1})),[[y,["system:role:add"]]]),d((g(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"success",icon:"edit",plain:"",onClick:e[4]||(e[4]=t=>F()),disabled:L.value},{default:a(()=>e[18]||(e[18]=[k("ä¿®æ”¹")])),_:1,__:[18]},8,["disabled"])]),_:1})),[[y,["system:role:update"]]]),d((g(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"danger",icon:"delete",plain:"",onClick:e[5]||(e[5]=t=>fe()),disabled:Y.value},{default:a(()=>e[19]||(e[19]=[k("åˆ é™¤")])),_:1,__:[19]},8,["disabled"])]),_:1})),[[y,["system:role:delete"]]]),d((g(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"warning",icon:"download",plain:""},{default:a(()=>e[20]||(e[20]=[k("å¯¼å‡º")])),_:1,__:[20]})]),_:1})),[[y,["system:role:export"]]]),d((g(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"info",icon:"upload",plain:""},{default:a(()=>e[21]||(e[21]=[k("å¯¼å…¥")])),_:1,__:[21]})]),_:1})),[[y,["system:role:import"]]]),d((g(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"success",icon:"Postcard",plain:"",disabled:L.value,onClick:e[6]||(e[6]=t=>G())},{default:a(()=>e[22]||(e[22]=[k("åˆ†é…èœå•")])),_:1,__:[22]},8,["disabled"])]),_:1})),[[y,["system:role:import"]]]),d((g(),h(m,{span:1.5},{default:a(()=>[l(c,{type:"info",icon:"upload",plain:""},{default:a(()=>e[23]||(e[23]=[k("æµ‹è¯•")])),_:1,__:[23]})]),_:1})),[[y,["system:role:xxx"]]]),l(ye,{showSearch:E.value,"onUpdate:showSearch":e[7]||(e[7]=t=>E.value=t),onRefreshTable:v},null,8,["showSearch"])]),_:1}),e[24]||(e[24]=Q("br",null,null,-1)),d((g(),h(ke,{border:"",data:X.value,"empty-text":"æš‚æ—¶æ²¡æœ‰æ•°æ®å“ŸðŸŒ»",onSelectionChange:re},{default:a(()=>[l(b,{type:"selection",width:"55",align:"center"}),l(b,{label:"åºå·",prop:"roleId",width:"120px",align:"center",type:"index"}),l(b,{label:"è§’è‰²åç§°",prop:"roleName",width:"120px","show-overflow-tooltip":!0,align:"center"}),l(b,{label:"è§’è‰²ç¼–å·",prop:"roleCode",width:"120px",align:"center"}),l(b,{label:"è§’è‰²çŠ¶æ€",prop:"roleStatus",width:"100px",align:"center"},{default:a(t=>[l(he,{modelValue:t.row.roleStatus,"onUpdate:modelValue":R=>t.row.roleStatus=R,"active-text":"å¯ç”¨","inactive-text":"åœç”¨","active-value":"0","inactive-value":"1","inline-prompt":!0,onChange:R=>ce(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(b,{label:"è§’è‰²æŽ’åº",prop:"sorted",width:"100px",align:"center"}),l(b,{label:"è§’è‰²å¤‡æ³¨",prop:"remark",width:"260px","show-overflow-tooltip":!0,align:"center"}),l(b,{label:"åˆ›å»ºæ—¶é—´",prop:"createTime",width:"180px",align:"center"}),l(b,{label:"æ“ä½œ",align:"center",width:"150",fixed:"right"},{default:a(({row:t})=>[l(A,{content:"ä¿®æ”¹ðŸŒ»",placement:"top"},{default:a(()=>[d(l(c,{type:"primary",icon:"Edit",circle:"",plain:"",onClick:R=>F(t)},null,8,["onClick"]),[[y,["system:role:update"]]])]),_:2},1024),l(A,{content:"åˆ é™¤ðŸŒ»",placement:"top"},{default:a(()=>[d(l(c,{type:"danger",icon:"Delete",circle:"",plain:"",onClick:R=>me(t)},null,8,["onClick"]),[[y,["system:role:delete"]]])]),_:2},1024),l(A,{content:"åˆ†é…èœå•ðŸŒ»",placement:"top"},{default:a(()=>[d(l(c,{type:"info",icon:"Postcard",circle:"",plain:"",onClick:R=>G(t)},null,8,["onClick"]),[[y,["system:role:delete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Ke,ae.value]]),e[25]||(e[25]=Q("br",null,null,-1)),d(l(be,{background:"","current-page":p.value.pageNo,"onUpdate:currentPage":e[8]||(e[8]=t=>p.value.pageNo=t),"page-size":p.value.pageSize,"onUpdate:pageSize":e[9]||(e[9]=t=>p.value.pageSize=t),"page-sizes":[10,20,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:z.value,onSizeChange:v,onCurrentChange:v},null,8,["current-page","page-size","total"]),[[ee,z.value>0]]),l(xe,{ref_key:"koiDialogRef",ref:S,title:K.value,onKoiConfirm:ie,onKoiCancel:pe,loading:_.value},{content:a(()=>[l(J,{ref_key:"formRef",ref:O,rules:de,model:f(r),"label-width":"80px","status-icon":""},{default:a(()=>[l(B,null,{default:a(()=>[l(m,{xs:{span:24},sm:{span:12}},{default:a(()=>[l(n,{label:"è§’è‰²åç§°",prop:"roleName"},{default:a(()=>[l(i,{modelValue:f(r).roleName,"onUpdate:modelValue":e[10]||(e[10]=t=>f(r).roleName=t),placeholder:"è¯·è¾“å…¥è§’è‰²åç§°",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:a(()=>[l(n,{label:"è§’è‰²ç¼–å·",prop:"roleCode"},{default:a(()=>[l(i,{modelValue:f(r).roleCode,"onUpdate:modelValue":e[11]||(e[11]=t=>f(r).roleCode=t),placeholder:"è¯·è¾“å…¥è§’è‰²ç¼–å·",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(B,null,{default:a(()=>[l(m,{xs:{span:24},sm:{span:12}},{default:a(()=>[l(n,{label:"è§’è‰²çŠ¶æ€",prop:"roleStatus"},{default:a(()=>[l(T,{modelValue:f(r).roleStatus,"onUpdate:modelValue":e[12]||(e[12]=t=>f(r).roleStatus=t),placeholder:"è¯·é€‰æ‹©è§’è‰²çŠ¶æ€",style:{width:"260px"},clearable:""},{default:a(()=>[l(w,{label:"å¯ç”¨",value:"0"}),l(w,{label:"åœç”¨",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:{span:24},sm:{span:12},class:"p-l-10px"},{default:a(()=>[l(n,{label:"è§’è‰²æŽ’åº",prop:"sorted"},{default:a(()=>[l(Ce,{modelValue:f(r).sorted,"onUpdate:modelValue":e[13]||(e[13]=t=>f(r).sorted=t),style:{width:"260px"},clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(B,null,{default:a(()=>[l(m,{xs:{span:24},sm:{span:24}},{default:a(()=>[l(n,{label:"è§’è‰²å¤‡æ³¨",prop:"remark"},{default:a(()=>[l(i,{modelValue:f(r).remark,"onUpdate:modelValue":e[14]||(e[14]=t=>f(r).remark=t),rows:5,type:"textarea",placeholder:"è¯·è¾“å…¥è§’è‰²å¤‡æ³¨"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"]),k(" "+Re(f(r)),1)]),_:1},8,["title","loading"]),l(Ne,{ref_key:"koiDrawerRef",ref:q,title:K.value,size:"360",onKoiConfirm:ge,onKoiCancel:_e,loading:_.value,cancelText:"å…³é—­"},{content:a(()=>[Q("div",null,[l(we,{ref_key:"treeRef",ref:U,data:H.value,"show-checkbox":"","default-expand-all":!1,"default-expanded-keys":Z.value,"node-key":"menuId","highlight-current":"",props:ve},null,8,["data","default-expanded-keys"])])]),_:1},8,["title","loading"])]),_:1,__:[24,25]})])}}});export{Ge as default};
