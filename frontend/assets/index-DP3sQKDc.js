import{d as Q,P as re,c as pe,a as M,r as ue,o as me,g as i,e as k,i as v,f as t,w as o,y as N,m as _e,j as l,k as n,t as z,F as H,l as K,z as u,Y as ve,N as T,Z as E,$ as fe,a0 as ce,a1 as ge,M as m,O as be,_ as ye}from"./index-_hVn5I9W.js";const we={class:"p-4px"},he={class:"card-header"},ke={class:"card-header"},Te={key:0},xe={class:"card-header"},$e={key:0},Se={class:"game-download-container"},Me={class:"card-header"},ze={class:"version-content"},Le={class:"version-select"},Ce={class:"download-links mt-4"},Ve={class:"direct-download-buttons"},je={class:"card-header"},De={class:"version-content"},Ne={class:"version-select"},Be={class:"download-links mt-4"},Fe={class:"direct-download-buttons"},Oe={class:"card-header"},Pe={class:"version-content"},Re={class:"version-select"},Ue={class:"download-links mt-4"},Ee={class:"direct-download-buttons"},We={class:"version-content"},Ge={class:"mt-4"},Ie=Q({name:"downloadPage"}),Je=Q({...Ie,setup(Ye){const X=re(),W=pe(()=>{const s=X.path;return s.includes("/vanilla")?"original":s.includes("/modded")?"modded":s.includes("/plugin")?"plugin":"original"}),x=M({version:"1449"}),g=M({version:"v2025.04.3.0"}),b=M({version:"TShock-5.2-for-Terraria-1.4.4.9-linux-x64-Release.zip"}),f=M({type:"original",file:null}),G=ue(!1),$=M({downloadDir:{path:"",fileCount:0,files:[]},installDirs:[]}),I=()=>{fetch("/api/download-status").then(s=>s.json()).then(s=>{s.success?(Object.assign($,s),G.value=!0):m({message:`获取状态失败: ${s.message||"未知错误"}`,type:"error"})}).catch(s=>{m({message:`获取状态出错: ${s.message}`,type:"error"})})},ee=s=>{switch(s){case"server":return"原版服务器";case"TMLserver":return"模组版服务器";case"TSserver":return"插件版服务器";default:return s}};me(()=>{I()});const B=s=>{let e="",r="",p="";switch(s){case"original":p=`terraria-server-${x.version}.zip`,e=`开始下载泰拉瑞亚原版 v${x.version.replace(/(\d)(\d)(\d)(\d)/,"$1.$2.$3.$4")}`,r=`https://terraria.org/api/download/pc-dedicated-server/${p}`;break;case"modded":p=`tModLoader-${g.version}.zip`,e=`开始下载tModLoader ${g.version}`,r=`https://github.com/tModLoader/tModLoader/releases/download/${g.version}/tModLoader.zip`;break;case"plugin":p=b.version,e=`开始下载TShock ${b.version}`,r=`https://github.com/Pryaxis/TShock/releases/download/v${b.version.split("-")[1]}/TShock-${b.version.split("-")[1]}-for-Terraria-${b.version.split("-")[3]}-linux-x64-Release.zip`;break;default:e="开始下载..."}fetch("/api/download-game",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:r,fileName:p,type:s})}).then(_=>_.json()).then(_=>{_.success?m({message:`${e}，下载任务已开始。下载完成后会自动解压安装。`,type:"success"}):m({message:`下载失败: ${_.message||"未知错误"}`,type:"error"})}).catch(_=>{m({message:`下载出错: ${_.message}`,type:"error"})})},te=s=>{f.file=s.raw||s},oe=()=>{if(!f.file){m.warning("请先选择文件");return}m({message:`正在上传 ${f.file.name||"未知文件"} 并安装为${f.type==="original"?"原版游戏":f.type==="modded"?"模组版":"插件版"}`,type:"success"})},F=s=>{const e=s.substring(s.lastIndexOf("/")+1),r=s.includes("tModLoader")?"modded":s.includes("TShock")?"plugin":"original";fetch("/api/download-game",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s,fileName:e,type:r})}).then(p=>p.json()).then(p=>{p.success?m({message:"下载任务已开始。下载完成后会自动解压安装。",type:"success"}):m({message:`下载失败: ${p.message||"未知错误"}`,type:"error"})}).catch(p=>{m({message:`下载出错: ${p.message}`,type:"error"})})},O=s=>{s.includes("tModLoader/releases")||s.includes("TShock/releases")?(m({message:"正在加载版本信息...",type:"info"}),fetch("/api/game-versions",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{e.success?be.alert(`${s.includes("tModLoader")?"tModLoader":"TShock"} 可用版本：

${e.versions.join(`
`)}`,"版本信息",{confirmButtonText:"确定"}):window.open(s,"_blank")}).catch(e=>{window.open(s,"_blank")})):window.open(s,"_blank")};return(s,e)=>{const r=i("el-button"),p=i("el-tag"),_=i("el-table-column"),le=i("el-table"),J=i("el-empty"),c=i("el-card"),Y=i("el-icon"),P=i("el-col"),Z=i("el-row"),se=i("el-collapse-item"),ae=i("el-collapse"),R=i("el-image"),L=i("el-divider"),d=i("el-option"),C=i("el-select"),y=i("el-form-item"),V=i("el-form"),j=i("el-tab-pane"),U=i("el-option-group"),q=i("el-alert"),ne=i("el-upload"),ie=i("el-tabs"),w=i("el-link"),h=i("el-descriptions-item"),A=i("el-descriptions");return v(),k("div",we,[t(c,null,{header:o(()=>[l("div",he,[e[15]||(e[15]=l("h3",{class:"text-18px font-bold"},"下载游戏",-1)),t(r,{type:"primary",onClick:I,size:"small",icon:u(ge)},{default:o(()=>e[14]||(e[14]=[n("刷新状态")])),_:1,__:[14]},8,["icon"])])]),default:o(()=>[G.value?(v(),N(ae,{key:0},{default:o(()=>[t(se,{title:"下载与安装状态",name:"1"},{default:o(()=>[t(c,{class:"status-card",shadow:"never"},{header:o(()=>[l("div",ke,[e[16]||(e[16]=l("h4",null,"下载目录",-1)),t(p,null,{default:o(()=>{var a;return[n(z(((a=$.downloadDir)==null?void 0:a.fileCount)||0)+" 个文件",1)]}),_:1})])]),default:o(()=>{var a,S,D;return[(S=(a=$.downloadDir)==null?void 0:a.files)!=null&&S.length?(v(),k("div",Te,[t(le,{data:(D=$.downloadDir)==null?void 0:D.files,style:{width:"100%"}},{default:o(()=>[t(_,{prop:"name",label:"文件名"}),t(_,{prop:"size",label:"大小",width:"120"}),t(_,{prop:"modTime",label:"修改时间",width:"200"})]),_:1},8,["data"])])):(v(),N(J,{key:1,description:"暂无下载文件"}))]}),_:1}),t(Z,{gutter:20,class:"mt-4"},{default:o(()=>[(v(!0),k(H,null,K($.installDirs,a=>(v(),N(P,{key:a.name,span:8},{default:o(()=>[t(c,{class:"status-card",shadow:"never"},{header:o(()=>[l("div",xe,[l("h4",null,z(ee(a.name)),1),t(p,{type:a.exists?"success":"info"},{default:o(()=>[n(z(a.exists?a.fileCount+" 个文件":"未创建"),1)]),_:2},1032,["type"])])]),default:o(()=>{var S;return[(S=a.files)!=null&&S.length?(v(),k("div",$e,[(v(!0),k(H,null,K(a.files,(D,de)=>(v(),k("p",{key:de,class:"file-item"},[t(Y,null,{default:o(()=>[t(u(ve))]),_:1}),n(" "+z(D),1)]))),128))])):(v(),N(J,{key:1,description:"目录为空"}))]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):_e("",!0),l("div",Se,[t(ie,{modelValue:W.value,"onUpdate:modelValue":e[13]||(e[13]=a=>W.value=a),type:"border-card"},{default:o(()=>[t(j,{label:"原版",name:"original"},{default:o(()=>[t(c,{shadow:"hover",class:"version-card"},{header:o(()=>[l("div",Me,[e[18]||(e[18]=l("h4",null,"泰拉瑞亚原版",-1)),t(p,{type:"success"},{default:o(()=>e[17]||(e[17]=[n("推荐")])),_:1,__:[17]})])]),default:o(()=>[l("div",ze,[e[24]||(e[24]=l("p",{class:"text-14px text-gray-500 mb-4"},"官方原版泰拉瑞亚游戏，适合普通玩家。当前最新版本: v1.4.4.9",-1)),t(R,{src:"https://cdn.akamai.steamstatic.com/steam/apps/105600/header.jpg",fit:"cover",class:"version-image"}),t(L,{"content-position":"center"},{default:o(()=>e[19]||(e[19]=[n("版本选择")])),_:1,__:[19]}),l("div",Le,[t(V,{model:x,"label-position":"top"},{default:o(()=>[t(y,{label:"选择游戏版本"},{default:o(()=>[t(C,{modelValue:x.version,"onUpdate:modelValue":e[0]||(e[0]=a=>x.version=a),placeholder:"请选择版本",style:{width:"100%"}},{default:o(()=>[t(d,{label:"v1.4.4.9 (最新)",value:"1449"}),t(d,{label:"v1.4.4.8",value:"1448"}),t(d,{label:"v1.4.4.7",value:"1447"}),t(d,{label:"v1.4.3.6",value:"1436"}),t(d,{label:"v1.4.2.3",value:"1423"})]),_:1},8,["modelValue"])]),_:1}),t(y,null,{default:o(()=>[t(r,{type:"primary",onClick:e[1]||(e[1]=a=>B("original")),style:{width:"100%"},size:"large",icon:u(T)},{default:o(()=>e[20]||(e[20]=[n("下载原版游戏")])),_:1,__:[20]},8,["icon"])]),_:1})]),_:1},8,["model"])]),l("div",Ce,[e[23]||(e[23]=l("h5",{class:"mb-2"},"直接下载链接:",-1)),l("div",Ve,[t(r,{type:"success",icon:u(T),onClick:e[2]||(e[2]=a=>F("https://terraria.org/api/download/pc-dedicated-server/terraria-server-1449.zip"))},{default:o(()=>e[21]||(e[21]=[n(" 泰拉瑞亚服务器 v1.4.4.9 ")])),_:1,__:[21]},8,["icon"]),t(r,{type:"info",icon:u(E),onClick:e[3]||(e[3]=a=>O("https://terraria.org/api/download/pc-dedicated-server/"))},{default:o(()=>e[22]||(e[22]=[n(" 查看所有版本 ")])),_:1,__:[22]},8,["icon"])])])])]),_:1})]),_:1}),t(j,{label:"模组版 (tModLoader)",name:"modded"},{default:o(()=>[t(c,{shadow:"hover",class:"version-card"},{header:o(()=>[l("div",je,[e[26]||(e[26]=l("h4",null,"泰拉瑞亚模组版 (tModLoader)",-1)),t(p,{type:"warning"},{default:o(()=>e[25]||(e[25]=[n("进阶")])),_:1,__:[25]})])]),default:o(()=>[l("div",De,[e[31]||(e[31]=l("p",{class:"text-14px text-gray-500 mb-4"},"官方模组加载器，可以安装各种模组扩展游戏内容。当前最新版本: v2025.04.3.0",-1)),t(R,{src:"https://cdn.akamai.steamstatic.com/steam/apps/1281930/header.jpg",fit:"cover",class:"version-image"}),t(L,{"content-position":"center"},{default:o(()=>e[27]||(e[27]=[n("版本选择")])),_:1,__:[27]}),l("div",Ne,[t(V,{model:g,"label-position":"top"},{default:o(()=>[t(y,{label:"选择模组加载器版本"},{default:o(()=>[t(C,{modelValue:g.version,"onUpdate:modelValue":e[4]||(e[4]=a=>g.version=a),placeholder:"请选择版本",style:{width:"100%"}},{default:o(()=>[t(U,{label:"最新稳定版"},{default:o(()=>[t(d,{label:"v2025.04.3.0 (最新稳定版)",value:"v2025.04.3.0"})]),_:1}),t(U,{label:"预览版"},{default:o(()=>[t(d,{label:"v2025.05.2.0 (最新预览版)",value:"v2025.05.2.0"}),t(d,{label:"v2025.04.2.2",value:"v2025.04.2.2"})]),_:1}),t(U,{label:"历史版本"},{default:o(()=>[t(d,{label:"v2025.04.2.1",value:"v2025.04.2.1"}),t(d,{label:"v2025.04.2.0",value:"v2025.04.2.0"}),t(d,{label:"v2025.03.3.1",value:"v2025.03.3.1"}),t(d,{label:"v2025.03.3.0",value:"v2025.03.3.0"}),t(d,{label:"v2025.03.2.12",value:"v2025.03.2.12"}),t(d,{label:"v2025.03.2.11",value:"v2025.03.2.11"}),t(d,{label:"v2025.03.2.9",value:"v2025.03.2.9"})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(y,null,{default:o(()=>[t(r,{type:"primary",onClick:e[5]||(e[5]=a=>B("modded")),style:{width:"100%"},size:"large",icon:u(T)},{default:o(()=>e[28]||(e[28]=[n("下载模组版")])),_:1,__:[28]},8,["icon"])]),_:1})]),_:1},8,["model"])]),l("div",Be,[e[30]||(e[30]=l("h5",{class:"mb-2"},"直接下载链接:",-1)),l("div",Fe,[t(r,{type:"success",icon:u(T),onClick:e[6]||(e[6]=a=>F(`https://github.com/tModLoader/tModLoader/releases/download/${g.version}/tModLoader.zip`))},{default:o(()=>[n(" tModLoader "+z(g.version),1)]),_:1},8,["icon"]),t(r,{type:"info",icon:u(E),onClick:e[7]||(e[7]=a=>O("https://github.com/tModLoader/tModLoader/releases"))},{default:o(()=>e[29]||(e[29]=[n(" 查看所有版本 ")])),_:1,__:[29]},8,["icon"])])]),t(q,{title:"安装提示",type:"info",description:"手动安装：请将下载的tModLoader.zip压缩包文件放进Terraria/TMLserver下，然后执行【手动上传安装】","show-icon":"",closable:!1,class:"mt-4"})])]),_:1})]),_:1}),t(j,{label:"插件版 (TShock)",name:"plugin"},{default:o(()=>[t(c,{shadow:"hover",class:"version-card"},{header:o(()=>[l("div",Oe,[e[33]||(e[33]=l("h4",null,"泰拉瑞亚插件版 (TShock)",-1)),t(p,{type:"danger"},{default:o(()=>e[32]||(e[32]=[n("专家")])),_:1,__:[32]})])]),default:o(()=>[l("div",Pe,[e[39]||(e[39]=l("p",{class:"text-14px text-gray-500 mb-4"},"TShock服务器，提供更多服务器管理功能和插件支持。适合开服使用。当前最新版本: v5.2",-1)),t(R,{src:"https://avatars.githubusercontent.com/u/4677545",fit:"cover",class:"version-image"}),t(L,{"content-position":"center"},{default:o(()=>e[34]||(e[34]=[n("版本选择")])),_:1,__:[34]}),l("div",Re,[t(V,{model:b,"label-position":"top"},{default:o(()=>[t(y,{label:"选择TShock版本"},{default:o(()=>[t(C,{modelValue:b.version,"onUpdate:modelValue":e[8]||(e[8]=a=>b.version=a),placeholder:"请选择版本",style:{width:"100%"}},{default:o(()=>[t(d,{label:"v5.2 for 1.4.4.9 (最新)",value:"TShock-5.2-for-Terraria-1.4.4.9-linux-x64-Release.zip"}),t(d,{label:"v5.1.3 for 1.4.4.8",value:"TShock-5.1.3-for-Terraria-1.4.4.8-linux-x64-Release.zip"}),t(d,{label:"v5.0 for 1.4.4.7",value:"TShock-5.0-for-Terraria-1.4.4.7-linux-x64-Release.zip"})]),_:1},8,["modelValue"])]),_:1}),t(y,null,{default:o(()=>[t(r,{type:"primary",onClick:e[9]||(e[9]=a=>B("plugin")),style:{width:"100%"},size:"large",icon:u(T)},{default:o(()=>e[35]||(e[35]=[n("下载插件版")])),_:1,__:[35]},8,["icon"])]),_:1})]),_:1},8,["model"])]),l("div",Ue,[e[38]||(e[38]=l("h5",{class:"mb-2"},"直接下载链接:",-1)),l("div",Ee,[t(r,{type:"success",icon:u(T),onClick:e[10]||(e[10]=a=>F("https://github.com/Pryaxis/TShock/releases/download/v5.2/TShock-5.2-for-Terraria-1.4.4.9-linux-x64-Release.zip"))},{default:o(()=>e[36]||(e[36]=[n(" TShock v5.2 ")])),_:1,__:[36]},8,["icon"]),t(r,{type:"info",icon:u(E),onClick:e[11]||(e[11]=a=>O("https://github.com/Pryaxis/TShock/releases/latest"))},{default:o(()=>e[37]||(e[37]=[n(" 查看最新版本 ")])),_:1,__:[37]},8,["icon"])])]),t(q,{title:"安装提示",type:"info",description:"手动安装：请将下载的压缩包文件放进Terraria/TSserver下，然后执行【手动上传安装】","show-icon":"",closable:!1,class:"mt-4"})])]),_:1})]),_:1}),t(j,{label:"手动上传安装",name:"manual"},{default:o(()=>[t(c,{shadow:"hover",class:"version-card"},{header:o(()=>e[40]||(e[40]=[l("div",{class:"card-header"},[l("h4",null,"手动上传安装")],-1)])),default:o(()=>[l("div",We,[e[44]||(e[44]=l("p",{class:"text-14px text-gray-500 mb-4"},"如果您已经下载了游戏文件，可以通过此功能上传并安装",-1)),t(ne,{class:"upload-demo",drag:"",action:"#","auto-upload":!1,"on-change":te,limit:1},{tip:o(()=>e[41]||(e[41]=[l("div",{class:"el-upload__tip"}," 请上传zip格式的游戏文件，大小不超过500MB ",-1)])),default:o(()=>[t(Y,{class:"el-icon--upload"},{default:o(()=>[t(u(fe))]),_:1}),e[42]||(e[42]=l("div",{class:"el-upload__text"},[n(" 拖拽文件到此处，或 "),l("em",null,"点击上传")],-1))]),_:1,__:[42]}),l("div",Ge,[t(V,{model:f,"label-position":"top"},{default:o(()=>[t(y,{label:"选择安装类型"},{default:o(()=>[t(C,{modelValue:f.type,"onUpdate:modelValue":e[12]||(e[12]=a=>f.type=a),placeholder:"请选择安装类型",style:{width:"100%"}},{default:o(()=>[t(d,{label:"原版游戏",value:"original"}),t(d,{label:"模组版 (tModLoader)",value:"modded"}),t(d,{label:"插件版 (TShock)",value:"plugin"})]),_:1},8,["modelValue"])]),_:1}),t(y,null,{default:o(()=>[t(r,{type:"primary",onClick:oe,style:{width:"100%"},size:"large",icon:u(ce),disabled:!f.file},{default:o(()=>e[43]||(e[43]=[n("上传并安装")])),_:1,__:[43]},8,["icon","disabled"])]),_:1})]),_:1},8,["model"])])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(L,{"content-position":"center"},{default:o(()=>e[45]||(e[45]=[n("游戏资源")])),_:1,__:[45]}),t(Z,{gutter:20,class:"mt-4"},{default:o(()=>[t(P,{span:12},{default:o(()=>[t(c,{shadow:"hover"},{header:o(()=>e[46]||(e[46]=[l("div",{class:"card-header"},[l("h4",null,"官方资源")],-1)])),default:o(()=>[t(A,{column:1,border:""},{default:o(()=>[t(h,{label:"官方网站"},{default:o(()=>[t(w,{type:"primary",href:"https://terraria.org/",target:"_blank"},{default:o(()=>e[47]||(e[47]=[n("https://terraria.org/")])),_:1,__:[47]})]),_:1}),t(h,{label:"Steam商店页面"},{default:o(()=>[t(w,{type:"primary",href:"https://store.steampowered.com/app/105600/Terraria/",target:"_blank"},{default:o(()=>e[48]||(e[48]=[n("https://store.steampowered.com/app/105600/Terraria/")])),_:1,__:[48]})]),_:1}),t(h,{label:"官方Wiki"},{default:o(()=>[t(w,{type:"primary",href:"https://terraria.wiki.gg/",target:"_blank"},{default:o(()=>e[49]||(e[49]=[n("https://terraria.wiki.gg/")])),_:1,__:[49]})]),_:1})]),_:1})]),_:1})]),_:1}),t(P,{span:12},{default:o(()=>[t(c,{shadow:"hover"},{header:o(()=>e[50]||(e[50]=[l("div",{class:"card-header"},[l("h4",null,"社区资源")],-1)])),default:o(()=>[t(A,{column:1,border:""},{default:o(()=>[t(h,{label:"中文Wiki"},{default:o(()=>[t(w,{type:"primary",href:"https://terraria.wiki.gg/zh/wiki/Terraria_Wiki",target:"_blank"},{default:o(()=>e[51]||(e[51]=[n("https://terraria.wiki.gg/zh/wiki/Terraria_Wiki")])),_:1,__:[51]})]),_:1}),t(h,{label:"模组数据库"},{default:o(()=>[t(w,{type:"primary",href:"https://steamcommunity.com/workshop/browse/?appid=1281930",target:"_blank"},{default:o(()=>e[52]||(e[52]=[n("Steam创意工坊")])),_:1,__:[52]})]),_:1}),t(h,{label:"中文论坛"},{default:o(()=>[t(w,{type:"primary",href:"https://www.terraria-zh.com/",target:"_blank"},{default:o(()=>e[53]||(e[53]=[n("https://www.terraria-zh.com/")])),_:1,__:[53]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})])}}}),qe=ye(Je,[["__scopeId","data-v-f0182494"]]);export{qe as default};
